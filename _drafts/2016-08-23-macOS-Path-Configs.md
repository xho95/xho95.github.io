맥을 사용하다보면 가끔씩 환경 설정에서 경로 (`$PATH`) 를 추가해야 할 경우가 있습니다. [^SeonHo] 이는 보통의 경우 터미널에서 절대 경로를 쓰지 않고 명령을 실행하고 싶을 때 사용합니다.

여기서는 이와 같은 상황에서 맥에 환경 변수를 설정하는 방법을 정리합니다. [^sjpison]  [^elfinlas]

### 들어가며 

맥과 리눅스는 구분해서 정리하도록 합니다. 하지만 많은 부분에서 내용이 동일할 것 같습니다.

왠지 **/etc/paths** 는 맥에만 있는 설정 파일인 것 같습니다. 일단 리눅스에는 기본으로 있지는 않은 것 같습니다.

### 쉘 경로 (shell path)

일단 쉘 경로 (shell path) 라는 것은 파일 시스템의 절대 경로들를 말하는데 각각은 콜론 (`:`) 으로 구분됩니다. [^coolest-path] 

현재의 경로가 어떻게 설정되어 있는지는 터미널에서 아래와 같은 명령을 수행하면 알 수 있습니다.

```
$ echo $PATH
```

결과는 아래와 비슷하게 나타납니다.

```
... /usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin ...
```

위의 5개의 디렉토리는 유닉스 계열 응용 프로그램들이 위치하는 파일 시스템의 기본 위치 5군데를 보여줍니다.

#### 임시로 경로 추가하기

아래와 같이 PATH 변수에 값을 할당해서 임시로 경로를 추가할 수 있습니다. 일단 `PATH=` 뒤에 기존 경로를 복사해 넣고, 이후에 자신이 원하는 경로를 추가하면 됩니다.

```
$ PATH=... /usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin: ... :/usr/local/test
```

이렇게 한 후 `$ echo $PATH` 를 실행하면 뒤에 `/usr/local/test` 경로가 추가된 것을 알 수 있습니다.

다만 이 방법은 현재의 터미널 세션이 유효할 때만 의미가 있습니다. 새 터미널을 실행하면 다시 기존 경로들로 되돌아 갑니다.

#### 고정으로 경로 추가하기

새로 추가할 경로를 항상 추가된 상태로 만들려면 홈 디렉토리에 **.bash_profile** 파일을 만들고  이곳에 경로 설정을 해야 합니다. [^xho95-directory]

홈 디렉토리로 이동해서 **.bash_profile** 을 만듭니다. 자신이 원하는 아무 에디터나 상관없지만 보통 터미널에서 자주 사용하는 `vim` 으로는 다음과 같습니다.

```
$ cd ~
$ vi .bash_profile
```

**.bash_profile** 파일에 아래와 같이 입력합니다. 아래에서 `/usr/local/test` 부분을 자신이 원하는 경로로 대체하면 됩니다.

```
export PATH="/usr/local/test:$PATH"
```

하지만 이 방법은 맥에서는 되는지 몰라도 리눅스에서는 마음대로 안되는 것 같습니다.


### 환경 변수 설정

쉘이 시작할 때 불러오는 파일에는 어떤 규칙이 있는 것 같습니다. [^gnu-bash-startup] 나중에 배쉬에 대한 내용만 따로 정리해야할지도 모르겠습니다. [^gnu-bash-tilde] [^tldp-bash-guide]

[What it is and How to Modify the Shell Path in macOS Sierra and OSX using Terminal](https://coolestguidesontheplanet.com/add-shell-path-osx/) 글이 괜찮은 해법을 제시하는 것 같습니다. 정리해야할 것 같습니다.  

#### 환경 파일들 호출 순서 (예상)

[Mac OS X의 PATH 설정 프로세스 (/etc/paths)](http://ohgyun.com/390) 글을 참고하여 환경 변수 파일들의 호출 순서를 정리하였습니다. [^ohgyun-390]

1. 로그인 쉘 시작
2. **/etc/profile** 실행
3. **/usr/libexec/path_helper** 실행
4. **/usr/libexec/path_helper** 가 **/etc/paths** 로 부터 라인 순서대로 초기 PATH 설정
5. **/etc/paths.d** 디렉토리에 있는 파일로부터 오름차순으로 PATH 설정
6. 시스템의 중요 경로가 누락된 경우 중복된 것을 제외하고 PATH 에 추가
7. **/usr/bin:/bin:/usr/sbin:/sbin** 등을 PATH 에 추가

위 순서에 따르면 **/etc/paths** 보다  **/etc/profile** 가 빨리 호출됨을 알 수 있습니다.

### 환경 변수 파일들

Path 를 설정하기 위한 파일들에는 아래와 같은 것들이 있다고 합니다. 

```
~/.bash_profile
~/.profile
/etc/paths
~/.bash_login
```

`~/.bash_profile`, `~/.profile`, 및 `~/.bash_login`의 경우 사용자 path 파일이며 처음부터 존재 하지는 않으니 새로 생성해줘야 한다고 합니다.[^TutorialBook]  

각각의 파일들이 차이점이 무엇인지는 계속 알아봐야할 것 같습니다. [^StefaanLippens]

macOS Shell 전반에 대한 내용은 [bash on Mac OS X](http://appletree.or.kr/forum/viewtopic.php?id=13) 글을 참고해도 좋을 것 같습니다. [^appletree-13]

[3.1. Shell initialization files](http://www.tldp.org/LDP/Bash-Beginners-Guide/html/Bash-Beginners-Guide.html#sect_03_01) 라는 아주 좋은 자료가 있습니다. [^tldp-sect-03-01] 아래의 내용은 이 자료를 정리한 것입니다.

#### 시스템 범위의 설정 파일들

1. **/etc/profile**

	When invoked interactively with the `--login` option or when invoked as **sh**, Bash reads the **/etc/profile** instructions. These usually set the shell variables `PATH`, `USER`, `MAIL`, `HOSTNAME` and `HISTSIZE`.

	On some systems, the umask value is configured in **/etc/profile**; on other systems this file holds pointers to other configuration files such as:

	* **/etc/inputrc**, the system-wide Readline initialization file where you can configure the command line bell-style.
	* the **/etc/profile.d** directory, which contains files configuring system-wide behavior of specific programs.

	모든 사용자 환경에 적용하고자 하는 모든 설정은 이 파일에 있어야 합니다.

2. **/etc/bashrc**

	시스템이 여러 종류의 쉘을 제공할 경우, 배쉬 셀에 특화된 설정은 이 파일에 두는 것이 더 좋습니다. 왜냐면 **/etc/profile** 은 다른 쉘에서도 불러들이기 때문입니다. Errors generated by shells that don't understand the Bash syntax are prevented by splitting the configuration files for the different types of shells. In such cases, the user's **~/.bashrc** might point to **/etc/bashrc** in order to include it in the shell initialization process upon login.

	You might also find that **/etc/profile** on your system only holds shell environment and program startup settings, while **/etc/bashrc** contains system-wide definitions for shell functions and aliases. **/etc/bashrc** 파일은 **/etc/profile** 또는 개별 사용자 쉘 초기화 파일에서 참조 될 수 있습니다.
	
#### 개별 사용자 설정 파일들

1. **~/.bash_profile**
2. **~/.bash_login**
3. **~/.profile**
4. **~/.bashrc**
5. **~/.bash_logout**

### 리눅스

[.profile에 설정한 내용이 터미널 에뮬레이터에서 안 먹힐 때](http://bakyeono.net/post/2015-09-05-source-profile-in-x-window-terminal.html) 글을 참고 합니다. [^bakyeono-terminal]

### 고찰하기

아직 완전한 자료가 아닌데 이해가 될 때까지 계속 정리하도록 합니다. 

### 참고 자료

[^sjpison]: [OS X 에서 환경변수 지정하는 방법!!](http://sjpison.tistory.com/258)

[^elfinlas]: [Mac에서 Path 설정하기](http://elfinlas.tistory.com/266) : **/etc/paths** 와 **/etc/profile** 에 대해서 설명을 한 글입니다.

[^TutorialBook]: [MAC 에서 path 설정하기](http://www.tutorialbook.co.kr/entry/MAC-에서-path-설정하기)

[^StefaanLippens]: [Bash: about .bashrc, .bash_profile, .profile, /etc/profile, etc/bash.bashrc and others](http://stefaanlippens.net/bashrc_and_others) ~/.bashrc, ~/.bash_profile, ~/.profile, /etc/profile, /etc/bash.bashrc 등의 여러 가지 비슷한 파일들의 차이점과 용도를 잘 설명한 글입니다.

[^appletree-13]: 글 자체는 오래되었지만, 원문도 좋고 번역도 잘 된 아주 좋은 글입니다.

[^SeonHo]: [MAC OS X 에서 $PATH 세팅 방법](http://seonhokim.net/2013/10/30/mac-os-x-에서-path-세팅-방법/) 새로운 binary를 $PATH에 등록하는 방법에 대해 잘 설명해 놓았습니다.

[^bakyeono-terminal]: [.profile에 설정한 내용이 터미널 에뮬레이터에서 안 먹힐 때](http://bakyeono.net/post/2015-09-05-source-profile-in-x-window-terminal.html)

[^gnu-bash-startup]: [6.2 Bash Startup Files](https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html) 글에는 배쉬 (Bash) 쉘이 어떻게 시작 파일들을 실행하는지를 설명하고 있습니다.

[^gnu-bash-tilde]: [3.5.2 Tilde Expansion](https://www.gnu.org/software/bash/manual/html_node/Tilde-Expansion.html#Tilde-Expansion)

[^tldp-bash-guide]: [Bash Guide for Beginners](http://www.tldp.org/LDP/Bash-Beginners-Guide/html/Bash-Beginners-Guide.html)

[^tldp-sect-03-01]: [3.1. Shell initialization files](http://www.tldp.org/LDP/Bash-Beginners-Guide/html/Bash-Beginners-Guide.html#sect_03_01) : 각 초기화 파일들에 대해서 자세히 설명한 글입니다.

[^ohgyun-390]: [Mac OS X의 PATH 설정 프로세스 (/etc/paths)](http://ohgyun.com/390) : macOS 에서 PATH 설정이 호출되는 순서를 설명한 글입니다. /etc/paths 와 /etc/profile 을 이해하는데 많은 도움이 될 것 같습니다. 

[^coolest-path]: [What it is and How to Modify the Shell Path in macOS Sierra and OSX using Terminal](https://coolestguidesontheplanet.com/add-shell-path-osx/) : 상당히 좋은 글인 것 같습니다. 결국 이 자료도 완벽하지는 않았습니다. 다만 맥과 리눅스의 차이로 인한 것일 수 있습닏.


[^xho95-directory]: 맥의 홈 디렉토리에 대해서는 [macOS: 맥의 기본 디렉토리 구조 살펴보기](http://xho95.github.io/macos/file/system/directory/2016/10/08/macOS-Directory-Structure.html) 글을 참고하시기 바랍니다.